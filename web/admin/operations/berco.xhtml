<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>

        <title>Sismar - Berço</title>

        <!-- Importações padrão -->
        <ui:include src="/admin/components/headdefault.xhtml" />           

        <!-- HighCharts -->
        <script src="https://code.highcharts.com/highcharts.js"></script>
        <script src="https://code.highcharts.com/modules/series-label.js"></script>
        <script src="https://code.highcharts.com/modules/exporting.js"></script>

        <!-- Script para gerar o gráfico -->
        <h:outputScript name="js/chartline.js" target="body"/>

    </h:head>

    <h:body>

        <div class="container-fluid" style="padding: 0px">           

            <!-- Importar menu -->
            <ui:include src="/admin/components/menu.xhtml" />

            <!-- Importar header -->
            <ui:include src="/admin/components/header.xhtml" />   

            <!-- Corpo do container: conteúdo -->
            <div id="content" class="col-xs-12">

                <!-- Título do conteúdo -->
                <div id="content-header" class="col-xs-12" style="margin-bottom: 20px">
                    <span id="content-title">Berço</span> 
                    <span id="content-subtitle">Informações para gestão</span>
                </div>

                #{BercoDashBean.ex2}
                
                <h:form>                   

                    <div class="row" style="margin-bottom: 15px !important">

                        <div class="col-xs-12 col-md-6 form-group" style="padding: 0px !important;">
                            <h:outputLabel class="col-sm-12" value="Berço:"/>
                            <div class="col-sm-12">
                                <h:selectOneMenu class="form-control"
                                                 value="#{BercoDashBean.bercoSelected}"
                                                 converter="bercoConverter"
                                                 >   
                                    <f:selectItems value="#{BercoDashBean.listBercos}" 
                                                   var="obj" 
                                                   itemLabel="#{obj.nome}" 
                                                   itemValue="#{obj}"/>
                                    <f:ajax event="change"
                                            render="jTmpOfStay jTmpDead jTmpOperative jtotalVessels jTimeline jTimeStayShipLast5 jInsights" 
                                            listener="#{BercoDashBean.reloadMetrics(null)}"/>
                                </h:selectOneMenu>
                            </div>
                        </div>
                        
                        <div class="col-xs-12 col-md-6 form-group" style="padding: 0px !important;">
                            <h:outputLabel class="col-sm-12" value="Período:"/>
                            <div class="col-sm-12">
                                <h:selectOneMenu class="form-control"
                                                 value="#{BercoDashBean.periodSelected}">                                      
                                    <f:selectItem itemValue = "1" itemLabel = "Últimos 7 dias" /> 
                                    <f:selectItem itemValue = "2" itemLabel = "Últimos 15 dias" /> 
                                    <f:selectItem itemValue = "3" itemLabel = "Últimos 30 dias" />                                     
                                    <f:ajax event="change"
                                            render="jTmpOfStay jTmpDead jTmpOperative jtotalVessels jTimeline jTimeStayShipLast5 jInsights" 
                                            listener="#{BercoDashBean.reloadMetrics(null)}"/>
                                </h:selectOneMenu>
                            </div>
                        </div>

                    </div>

                    <div class="row row-dash">

                        <!-- total de navios -->
                        <div class="col-xs-12 col-md-3">
                            <div class="card-dash card-dash-white">
                                <div class="card-dash-overview-info">
                                    <h6>Total de navios</h6>
                                    <h1><h:outputText id="jtotalVessels" value="#{BercoDashBean.totalVessels}"/></h1>
                                </div>
                                <div class="card-dash-icon">
                                    <img src="/sismar/faces/javax.faces.resource/img/icon-berco-vessel.png"
                                         height="28px"/>
                                </div>
                            </div>
                        </div>

                        <!-- tempo operante -->
                        <div class="col-xs-12 col-md-3">
                            <div class="card-dash card-dash-blue">
                                <div class="card-dash-overview-info">
                                    <h6>Tempo operante</h6>
                                    <h1><h:outputText id="jTmpOperative" value="#{BercoDashBean.tmpOperative}"/></h1>
                                </div>
                                <div class="card-dash-icon">
                                    <img src="/sismar/faces/javax.faces.resource/img/icon-berco-time-left.png"
                                         height="28px"/>
                                </div>
                            </div>
                        </div>

                        <!-- tempo inoperante -->
                        <div class="col-xs-12 col-md-3">
                            <div class="card-dash card-dash-gray">
                                <div class="card-dash-overview-info">
                                    <h6>Tempo inoperante</h6>
                                    <h1><h:outputText id="jTmpDead" value="#{BercoDashBean.tmpDead}"/></h1>
                                </div>
                                <div class="card-dash-icon">
                                    <img src="/sismar/faces/javax.faces.resource/img/icon-berco-time-left.png"
                                         height="28px"/>
                                </div>
                            </div>
                        </div>

                        <!-- tempo de estadia -->
                        <div class="col-xs-12 col-md-3">
                            <div class="card-dash card-dash-orange">
                                <div class="card-dash-overview-info">
                                    <h6>Tempo médio de estadia</h6>
                                    <h1><h:outputText id="jTmpOfStay" value="#{BercoDashBean.tmpOfStay}"/></h1>
                                </div>
                                <div class="card-dash-icon">
                                    <img src="/sismar/faces/javax.faces.resource/img/icon-berco-time-left.png"
                                         height="28px"/>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="row row-dash">

                        <!-- timeline -->
                        <div class="col-xs-12 col-md-3">
                            <div class="card-dash-details card-dash-details-white">
                                <div class="col-xs-12 card-dash-details-title">
                                    <h6>Timeline</h6>
                                    <span>Últimos eventos do período</span>
                                </div>

                                <div class="col-xs-12 card-dash-details-content">

                                    <p:panel id="jTimeline">
                                        <p:repeat value="#{BercoDashBean.listTimeline}" var="timeline">

                                            <div class="col-xs-12 card-dash-details-content-row">
                                                <div class="col-xs-1 card-dash-content-icon">
                                                    <img src="/sismar/faces/javax.faces.resource/img/#{timeline.icon}"
                                                         height="16px"/>
                                                </div>
                                                <div class="col-xs-11 card-dash-content-value">
                                                    <span class="card-dash-content-value-text">#{timeline.description}</span>
                                                    <span class="card-dash-content-value-time">#{timeline.formattedDate}</span>
                                                </div>
                                            </div>

                                        </p:repeat>
                                    </p:panel>

                                    <!--
                                    <div class="col-xs-12 card-dash-details-content-row">
                                        <div class="col-xs-1 card-dash-content-icon">
                                            <img src="/sismar/faces/javax.faces.resource/img/icon-berco-up-arrow.png"
                                                 height="16px"/>
                                        </div>
                                        <div class="col-xs-11 card-dash-content-value">
                                            <span class="card-dash-content-value-text">Nasaka entrou no berço com velocidade de 12 nós</span>
                                            <span class="card-dash-content-value-time">10 min atrás</span>
                                        </div>
                                    </div>

                                    <div class="col-xs-12 card-dash-details-content-row">
                                        <div class="col-xs-1 card-dash-content-icon">
                                            <img src="/sismar/faces/javax.faces.resource/img/icon-berco-up-down.png"
                                                 height="16px"/>
                                        </div>
                                        <div class="col-xs-11 card-dash-content-value">
                                            <span class="card-dash-content-value-text">Nasaka saiu no berço com velocidade de 12 nós</span>
                                            <span class="card-dash-content-value-time">20 min atrás</span>
                                        </div>
                                    </div>-->

                                </div>
                            </div>
                        </div>

                        <!-- tempo de estadia dos ultimos 5 navios -->
                        <div class="col-xs-12 col-md-6">
                            <div class="card-dash-details card-dash-details-white">
                                <div class="col-xs-12 card-dash-details-title">
                                    <h6>Tempo de estadia</h6>
                                    <span>Últimos 5 navios</span>
                                </div>

                                <div class="col-xs-12 card-dash-details-content">

                                    <p:panel id="jTimeStayShipLast5">
                                        <p:repeat value="#{BercoDashBean.listTimeStayShipLast5}" var="timeStayShip">

                                            <div class="col-xs-12 card-dash-details-content-row">
                                                <span class="info-vessel">#{timeStayShip.name} <b>IMO: #{timeStayShip.imo}</b></span>
                                                <div class="progress-vessel">
                                                    <div class="col-xs-10 progress-vessel-col1">
                                                        <p:progressBar styleClass="customProgress" value="#{timeStayShip.pct}" labelTemplate="" displayOnly="true"/>
                                                    </div>
                                                    <div class="col-xs-2 progress-vessel-col2">
                                                        #{timeStayShip.formattedDate}
                                                    </div>
                                                </div>
                                            </div>

                                        </p:repeat>
                                    </p:panel>

                                    <!--<div class="col-xs-12 card-dash-details-content-row">
                                        <span class="info-vessel">Nikolaos <b>IMO: 123212</b></span>
                                        <div class="progress-vessel">
                                            <div class="col-xs-10 progress-vessel-col1">
                                                <p:progressBar styleClass="customProgress" value="50" labelTemplate="" displayOnly="true"/>
                                            </div>
                                            <div class="col-xs-2 progress-vessel-col2">
                                                12h32m
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-xs-12 card-dash-details-content-row">
                                        <span class="info-vessel">Ataulfo alves <b>IMO: 123212</b></span>
                                        <div class="progress-vessel">
                                            <div class="col-xs-10 progress-vessel-col1">
                                                <p:progressBar styleClass="customProgress" value="80" labelTemplate="" displayOnly="true"/>
                                            </div>
                                            <div class="col-xs-2 progress-vessel-col2">
                                                22h32m
                                            </div>
                                        </div>
                                    </div>-->

                                </div>
                            </div>
                        </div>

                        <!-- tempo de estadia -->
                        <div class="col-xs-12 col-md-3">
                            <div class="card-dash-details card-dash-details-white">
                                <div class="col-xs-12 card-dash-details-title">
                                    <h6>Tempo de estadia</h6>
                                    <span>Visão gráfica do período</span>
                                </div>

                                <div class="col-xs-12 card-dash-details-content">

                                    <div id="chart" style="height: 250px;"></div>                                    

                                    <div class="card-dash-details-content-insights">
                                        <h6>Insights</h6>
                                        <ul style="margin-top: 10px">
                                            <p:panel id="jInsights">
                                                <p:repeat value="#{BercoDashBean.listInsights}" var="insight">
                                                    <li style="font-size: 13px; margin-top: 5px">#{insight}</li>
                                                </p:repeat>
                                            </p:panel>
                                            <!--<li>Tempo de estadia mínima: 02h40m</li>
                                            <li>Tempo de estadia média: 04h20m</li>-->
                                        </ul>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>

                </h:form>            

            </div> <!-- Fechamento do conteúdo -->  

        </div> <!-- Fechamento do container -->  

        <!-- Importar rodapé -->
        <ui:include src="/admin/components/footer.xhtml" />         

        <!-- Importações scripts -->
        <h:outputScript name="js/menu.js" target="body"/>

        <script>
            $(function () {

                $(".menu-operations").addClass("active");
                $(".menu-operations-berco").addClass("active-link");

            });

        </script>

    </h:body>

</html>